!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.CanvasNest=t()}(this,function(){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)},t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||window.clearTimeout,e=function(n){return new Array(n).fill(0).map(function(n,t){return t})},i=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},o=function(){function n(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();var a=function(){function a(n,t){var o=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.randomPoints=function(){return e(Math.ceil(o.c.count*o.canvas.width*o.canvas.height/4e5)).map(function(){return{x:Math.random()*o.canvas.width,y:Math.random()*o.canvas.height,xa:2*Math.random()-1,ya:2*Math.random()-1,xd:0,yd:0,max:6e3}})},this.el=n,console.log(t),this.c=i({zIndex:-1,opacity:.5,color:"0,0,0",pointColor:"0,0,0",count:99},t),this.canvas=this.newCanvas(),this.context=this.canvas.getContext("2d"),this.points=this.randomPoints(),this.current={x:null,y:null,max:2e4},this.all=this.points.concat([this.current]),this.bindEvent(),this.requestFrame(this.drawCanvas)}return o(a,[{key:"bindEvent",value:function(){var n=this;this.canvas.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.canvas.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.onmousemove=window.onmousemove,window.onmousemove=function(t){n.current.x=t.clientX,n.current.y=t.clientY,n.onmousemove&&n.onmousemove(t)}}},{key:"newCanvas",value:function(){var n,t=document.createElement("canvas");return console.log(this.c),t.style.cssText="display:block;position:fixed;top:0;left:0;overflow:hidden;pointer-events:none;z-index:"+(n=this.c).zIndex+";opacity:"+n.opacity,t.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.el.appendChild(t),t}},{key:"requestFrame",value:function(t){var e=this;this.tid=n(function(){return t.call(e)})}},{key:"drawCanvas",value:function(){var n=this,t=this.context,e=this.canvas.width,i=this.canvas.height,o=this.current,a=this.points,r=this.all;t.clearRect(0,0,e,i);var s=void 0,c=void 0,d=void 0,u=void 0,h=void 0,m=void 0,l=void 0,v=void 0;a.forEach(function(a,w){for(t.fillStyle="rgba("+n.c.pointColor+")",c=w+1;c<r.length;c++)null!==(s=r[c]).x&&null!==s.y&&(u=a.x-s.x,h=a.y-s.y,l=a.x+a.xa-s.x,v=a.y+a.ya-s.y,m=u*u+h*h,s===o&&(m<s.max?(a.xd=(Math.abs(l)>Math.abs(u)&&Math.abs(l)*Math.abs(u)>0?-1:1)*m/s.max*2*a.xa,a.yd=(Math.abs(v)>Math.abs(h)&&Math.abs(v)*Math.abs(h)>0?-1:1)*m/s.max*2*a.ya):(a.xd=0,a.yd=0)),m<s.max&&(d=(s.max-m)/s.max,t.beginPath(),t.lineWidth=d/2,t.strokeStyle="rgba("+n.c.color+","+(d+.2)+")",t.moveTo(a.x,a.y),t.lineTo(s.x,s.y),t.stroke()));a.x+=a.xa+a.xd,a.y+=a.ya+a.yd,a.xa*=a.x>e||a.x<0?-1:1,a.ya*=a.y>i||a.y<0?-1:1,t.fillRect(a.x-.5,a.y-.5,1,1)}),this.requestFrame(this.drawCanvas)}},{key:"destroy",value:function(){window.onmousemove=this.onmousemove,window.onmouseout=this.onmouseout,t(this.tid),this.canvas.parentNode.removeChild(this.canvas)}}]),a}();return a.version="2.0.4",a});
